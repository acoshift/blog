# ‡∏ó‡∏≥‡∏£‡∏∞‡∏ö‡∏ö Realtime ‡∏ö‡∏ô Web

‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏£‡∏∞‡∏ö‡∏ö chat, dashboard, ‡∏Å‡∏£‡∏≤‡∏ü ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• update ‡πÄ‡∏≠‡∏á ‡∏à‡∏∞‡∏ó‡∏≥‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏î‡∏µ ?

‡∏£‡∏∞‡∏ö‡∏ö Realtime ‡∏ó‡∏µ‡πà‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏ç‡πà‡∏ô‡∏¥‡∏¢‡∏°‡πÉ‡∏ä‡πâ‡πÉ‡∏ô web ‡∏°‡∏µ

1. Short Pulling
1. Long Pulling
1. Websocket
1. Server-Sent Event (SSE)

## Short Pulling

‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡πÑ‡∏õ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏Å ‡πÜ n ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ

### ‡∏Ç‡πâ‡∏≠‡∏î‡∏µ‡∏Ç‡∏≠‡∏á Short Pulling

- ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏≥‡∏£‡∏∞‡∏ö‡∏ö realtime ‡∏ó‡∏µ‡πà‡∏á‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
- ‡∏£‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô‡∏Å‡πá‡πÑ‡∏î‡πâ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å HTTP ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤

### ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏µ‡∏¢‡∏Ç‡∏≠‡∏á Short Pulling

- ‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏á resource ‡∏°‡∏≤‡∏Å ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô ‡∏Å‡πá‡∏à‡∏∞‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏•‡∏≠‡∏î‡πÄ‡∏ß‡∏•‡∏≤

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ Short Pulling

‡∏ù‡∏±‡πà‡∏á Server ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏•‡∏¢ (‡∏á‡πà‡∏≤‡∏¢‡πÑ‡∏´‡∏° üôà)

```go
func getDataShortPulling(w http.ResponseWriter, r *http.Request) {
    data := getData()

    w.Write(data)
}
```

‡∏ù‡∏±‡πà‡∏á Browser ‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢ ‡πÜ 2 ‡∏ß‡∏¥‡∏ò‡∏µ

1. setInterval - ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏á‡πà‡∏≤‡∏¢ ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤ server ‡∏ä‡πâ‡∏≤‡∏à‡∏∞‡πÇ‡∏î‡∏ô‡∏¢‡∏¥‡∏á

    ```js
    setInterval(fetchData, 3000) // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏Å 3 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
    ```

2. setTimeout - ‡∏¢‡∏±‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏á‡πà‡∏≤‡∏¢‡∏≠‡∏¢‡∏π‡πà

    ```js
    async function startPulling () {
        await fetchData() // ‡∏£‡∏≠‡πÉ‡∏´‡πâ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Å‡πà‡∏≠‡∏ô ‡∏Ñ‡πà‡∏≠‡∏¢‡∏£‡∏≠‡∏≠‡∏µ‡∏Å 3 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
        setTimeout(startPulling, 3000)
    }

    startPulling()
    ```

## Long Pulling

‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ ‡πÜ Short Pulling ‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà 2 ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ setTimeout ‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡πâ Server ‡∏£‡∏≠‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡πà‡∏≠‡∏¢‡∏ï‡∏≠‡∏ö api ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤

### ‡∏Ç‡πâ‡∏≠‡∏î‡∏µ‡∏Ç‡∏≠‡∏á Long Pulling

- ‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î resource ‡∏Å‡∏ß‡πà‡∏≤ Short Pulling
- ‡∏£‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô‡∏Å‡πá‡πÑ‡∏î‡πâ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å HTTP ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤

### ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏µ‡∏¢‡∏Ç‡∏≠‡∏á Long Pulling

- ‡∏°‡∏µ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÇ‡∏î‡∏ô timeout ‡∏ö‡πà‡∏≠‡∏¢
- ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏°‡∏µ‡∏ñ‡πâ‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢ ‡πÜ ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏°‡∏µ‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (api ‡∏ï‡∏≠‡∏ö response ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ ‡πÅ‡∏•‡πâ‡∏ß‡∏°‡∏µ data change ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà client ‡∏à‡∏∞‡∏¢‡∏¥‡∏á api ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏≠‡∏µ‡∏Å‡∏£‡∏≠‡∏ö)

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ Long Pulling

‡∏ù‡∏±‡πà‡∏á Server ‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≠‡πÉ‡∏´‡πâ Data ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Å‡πà‡∏≠‡∏ô ‡∏Ñ‡πà‡∏≠‡∏¢‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ

```go
func getDataLongPulling(w http.ResponseWriter, r *http.Request) {
    if r.URL.Query().Get("long") != "1" {
        getDataShortPulling(w, r)
        return
    }

    <-untilNewDataReceived()

    data := getData()

    w.Write(data)
}
```

‡∏ù‡∏±‡πà‡∏á Browser ‡∏¢‡∏±‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏á‡πà‡∏≤‡∏¢‡∏≠‡∏¢‡∏π‡πà

```js
async function startLongPulling () {
    await fetchDataLongPulling()
    startLongPulling()
}

fetchDataShortPulling() // ‡∏î‡∏∂‡∏á data ‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö‡∏Å‡πà‡∏≠‡∏ô
startLongPulling() // ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏Ñ‡πà‡∏≠‡∏¢‡πÉ‡∏ä‡πâ long pulling ‡∏£‡∏≠ data ‡πÉ‡∏´‡∏°‡πà
```

‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Ç‡∏≠‡∏á Long Pulling ‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠ ‡∏ñ‡πâ‡∏≤ data ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á request ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ data ‡∏ô‡∏±‡πâ‡∏ô ‡πÄ‡∏ä‡πà‡∏ô

```
           pull  pull
Client: ----|-----|-----
Server: -----|--|--|----
             1  2  wait
```

‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏ñ‡πâ‡∏≤ data ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å 1 ‡πÄ‡∏õ‡πá‡∏ô 2 ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ pull ‡∏≠‡∏¢‡∏π‡πà client ‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ data

‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡∏Ñ‡∏∑‡∏≠ ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á token (‡πÄ‡∏ä‡πà‡∏ô timestamp) ‡∏Ç‡∏≠‡∏á data ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÑ‡∏õ ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏ß‡∏•‡∏≤ pull ‡πÉ‡∏´‡πâ‡πÄ‡∏≠‡∏≤ token ‡∏ô‡∏±‡πâ‡∏ô‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏≤ server

## Web Socket

Web Socket ‡πÄ‡∏õ‡πá‡∏ô full-duplex communication ‡∏Ñ‡∏∑‡∏≠ client ‡∏Å‡∏±‡∏ö server ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ‡∏ú‡πà‡∏≤‡∏ô connection ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß

### ‡∏Ç‡πâ‡∏≠‡∏î‡∏µ‡∏Ç‡∏≠‡∏á Web Socket

- ‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î resource ‡πÑ‡∏°‡πà‡∏°‡∏µ overhead ‡∏Ç‡∏≠‡∏á http, ‡πÄ‡∏õ‡∏¥‡∏î connection ‡∏ó‡∏¥‡πâ‡∏á‡πÑ‡∏ß‡πâ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á data ‡πÑ‡∏õ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ
- ‡∏°‡∏µ library ‡∏Ñ‡∏£‡∏ö ‡πÅ‡∏ó‡∏ö‡∏ó‡∏∏‡∏Å‡∏†‡∏≤‡∏©‡∏≤

### ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏µ‡∏¢‡∏Ç‡∏≠‡∏á Web Socket

- ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ö‡∏ô Layer 4 (TCP) ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ middleware ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö HTTP Upgrade ‡∏Å‡πá‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ (‡πÄ‡∏ä‡πà‡∏ô Cloud Run)
- ‡∏°‡∏µ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÇ‡∏î‡∏ô timeout ‡∏ñ‡πâ‡∏≤ set middleware ‡πÑ‡∏°‡πà‡∏î‡∏µ (‡πÄ‡∏ä‡πà‡∏ô reverse proxy, load balancer, cdn)

## Server-Sent Event (SSE)

‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ ‡πÜ Web Socket ‡πÅ‡∏ï‡πà server push data ‡∏´‡∏≤ client ‡πÑ‡∏î‡πâ‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß

### ‡∏Ç‡πâ‡∏≠‡∏î‡∏µ‡∏Ç‡∏≠‡∏á Server-Sent Event

- ‡∏£‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô‡∏Å‡πá‡πÑ‡∏î‡πâ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ö‡∏ô HTTP ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤
- ‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î resource ‡∏Å‡∏ß‡πà‡∏≤ Short/Long Pulling
- ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏á‡πà‡∏≤‡∏¢ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ library

### ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏µ‡∏¢‡∏Ç‡∏≠‡∏á Server-Sent Event

- IE ‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ü§®
- ‡∏ñ‡πâ‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏≠‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á HTTP ‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡∏∂‡∏á

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ Server-Sent Event

‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏≤‡∏Ç‡∏≠‡∏á sse event

```
: ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ : ‡∏Ñ‡∏∑‡∏≠ comment

: ‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ä‡∏∑‡πà‡∏≠ event ‡πÑ‡∏î‡πâ
event: add
data: 1

event: remove
data: 1

: ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ä‡∏∑‡πà‡∏≠ event default ‡∏Ñ‡∏∑‡∏≠ event: message
data: hello, sse

: ‡∏ñ‡πâ‡∏≤ data ‡∏°‡∏µ 2 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î
data: hello,
data: sse
```

Server ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏°‡πà‡∏¢‡∏≤‡∏Å‡∏°‡∏≤‡∏Å ‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏±‡∏á‡πÑ‡∏á

```go
func getDataWithSSESupport(w http.ResponseWriter, r *http.Request) {
    // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏™‡πà‡∏á ?sse=1 ‡∏°‡∏≤ ‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏¢‡∏¥‡∏á‡∏°‡∏≤‡πÅ‡∏ö‡∏ö api ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤
    // ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏ó‡∏≥ api ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á api ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤ ‡∏ó‡∏±‡πâ‡∏á sse
    if r.URL.Query().Get("sse") != "1" {
        getDataShortPulling(w, r)
        return
    }

    w.Header().Set("Content-Type", "text/event-stream")
    w.Header().Set("Cache-Control", "no-cache") // ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ cache
    w.WriteHeader(http.StatusOK)

    for {
        data := getData()
        fmt.Fprintf(w, "data: %s\n\n", data)
        w.(http.Flusher).Flush()

        select {
        case <-untilNewDataReceived():
        case <-r.Context().Done():
            return
        }
    }
}
```

Browser ‡∏¢‡∏¥‡πà‡∏á‡∏á‡πà‡∏≤‡∏¢

```js
const source = new EventSource('/data')

source.addEventListener('add', (ev) => {
    //
})

source.addEventListener('remove', (ev) => {
    //
})

source.addEventListener('message', (ev) => {
    //
})

// ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏∞‡∏£‡∏±‡∏ö ‡∏ó‡∏∏‡∏Å event ‡∏°‡∏≤‡πÄ‡∏•‡∏¢
source.onmessage = (ev) => {
  console.log(ev)
}
```

‡∏•‡∏≠‡∏á‡πÄ‡∏≠‡∏≤‡πÑ‡∏õ‡∏£‡∏±‡∏ô‡πÄ‡∏•‡πà‡∏ô ‡πÜ

```go
package main

import (
	"fmt"
	"net/http"
	"time"
)

func main() {
	http.ListenAndServe(":8080", http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		if r.URL.Path == "/" {
			w.Write([]byte(`<!doctype html>
<div id=app></div>
<script>
const $app = document.getElementById('app')
const source = new EventSource('/data')
source.addEventListener('message', (ev) => {
	console.log(ev)
    app.innerHTML += ev.data + "<br>"
})
</script>`))
		}

		if r.URL.Path == "/data" {
			w.Header().Set("Content-Type", "text/event-stream")
			w.Header().Set("Cache-Control", "no-cache")
			w.WriteHeader(http.StatusOK)

			for {
				data := time.Now().Format(time.RFC3339)
				fmt.Fprintf(w, "data: %s\n\n", data)
				w.(http.Flusher).Flush()

				select {
				case <-time.After(time.Second):
				case <-r.Context().Done():
					return
				}
			}
		}
	}))
}
```

## ‡∏™‡∏£‡∏∏‡∏õ

- ‡πÉ‡∏ä‡πâ Server-Sent Event üôàüôàüôàüôàüôàüôà

‡∏ô‡∏≠‡∏Å‡∏à‡∏≤‡∏Å

- ‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÅ‡∏Å‡πâ code server
- ‡∏Ñ‡∏ô‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡πÄ‡∏¢‡∏≠‡∏∞
- data ‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á realtime ‡∏°‡∏≤‡∏Å

> ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ **Short Pulling**

### Note

- Web socket ‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏ß‡∏•‡∏≤ deploy ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ö‡∏≤‡∏á‡∏ó‡∏µ reverse proxy ‡πÑ‡∏°‡πà support http upgrade
‡πÅ‡∏ï‡πà library ‡∏ö‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏à‡∏∞ fallback ‡πÑ‡∏õ‡πÉ‡∏ä‡πâ short/long pulling ‡∏°‡∏µ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏ó‡∏µ‡πà server ‡∏à‡∏∞‡πÇ‡∏î‡∏ô request ‡∏¢‡∏¥‡∏á‡∏£‡∏±‡∏ß ‡πÜ
‡∏¢‡∏¥‡πà‡∏á‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ service ‡∏ó‡∏µ‡πà‡∏Ñ‡∏¥‡∏î‡∏ï‡∏±‡∏á‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô request ‡∏Å‡πá‡∏à‡∏∞‡πÇ‡∏î‡∏ô‡∏Ñ‡πà‡∏≤‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏¢‡∏≠‡∏∞‡∏°‡∏≤‡∏Å ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏´‡∏•‡∏≤‡∏¢‡∏•‡πâ‡∏≤‡∏ô request ‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô

- ‡∏ñ‡πâ‡∏≤‡∏à‡∏∞ support IE ‡∏Ñ‡πà‡∏≠‡∏¢‡πÉ‡∏ä‡πâ Long Pulling ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà support IE ‡πÑ‡∏õ‡πÉ‡∏ä‡πâ SSE ‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤

- ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏∞‡∏ó‡∏≥ Short Pulling ‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡πá‡πÑ‡∏î‡πâ ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏ô‡πÉ‡∏ä‡πâ‡πÄ‡∏¢‡∏≠‡∏∞‡∏Ñ‡πà‡∏≠‡∏¢‡πÉ‡∏´‡πâ api ‡πÄ‡∏î‡∏¥‡∏° support SSE ‡πÅ‡∏Å‡πâ code ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏°‡πà‡πÄ‡∏¢‡∏≠‡∏∞
